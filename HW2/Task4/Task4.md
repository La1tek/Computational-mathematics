# Task4 — Реализация метода Ричардсона решения системы уравнений

> Все произведенные вычисления находятся в файле [Task4.ipynb](/HW2/Task4/Task4.ipynb)

---

## Цель

- Реализовать метод Ричардсона решения системы уравнений из задачи **II.10.5д**.  
- Оптимальное значение параметра $\tau$ подобрать экспериментально, основываясь на оценке скорости сходимости метода на первых 10 итерациях.  
- При помощи степенного метода поиск максимального по модулю собственного значения оценить число обусловленности матрицы системы.  
- Используя оценку числа обусловленности, получить решение системы с относительной точностью $\varepsilon = 10^{-5}$.

---

## СЛАУ из *10.5 д)*

$$
a = 10
$$

$$
\begin{cases}
a x_1 + x_2 + x_3 + x_4 + x_5 & = 1 \\
x_1 + a x_2 + x_3 + x_4 + x_5 + x_6 & = 2 \\
x_1 + x_2 + a x_3 + x_4 + x_5 + x_6 + x_7 & = 3 \\
x_1 + x_2 + x_3 + a x_4 + x_5 + x_6 + x_7 + x_8 & = 4 \\
x_1 + x_2 + x_3 + x_4 + a x_5 + x_6 + x_7 + x_8 + x_9 & = 5 \\
\vdots & \vdots \\
x_{96} + x_{97} + x_{98} + x_{99} + a x_{100} & = 100
\end{cases}
$$

---

## Реализация метода Ричардсона

Итерационный процесс:
$$x^{(k+1)} = x^{(k)} - \tau (A x^{(k)} - b)$$

### Применим теорему Гершгорина

Каждое собственное значение матрицы $A$ лежит в одном из кругов:
$$|z - a_{ii}| \le R_i, \quad R_i = \sum_{j \ne i} |a_{ij}|$$

Для данной матрицы:
- Диагональные элементы: $a_{ii} = 10$
- Внедиагональные элементы: $a_{ij} = 1$ при $|i-j| \le 4$

Тогда $R_i \in [4,8]$, и:
$$2 \le \lambda_i \le 18$$

Матрица симметричная и положительно определённая, значит $\lambda_i > 0$ и $\tau \in (0, \frac{2}{\lambda_{max}}) = (0, \frac{1}{9})$.

---

## Оптимальное значение параметра $\tau$

Подбираем $\tau$ экспериментально на первых 10 итерациях, оценивая скорость убывания нормы $||x^{(k+1)} - x^{(k)}||$.  
По результатам эксперимента:

$$\tau_{opt} \approx 0.072$$

Графики:
- ![График сходимости метода Ричардсона](/img/tau.png)
- ![График выбранных τ](/img/tau_selected.png)
- ![График сходимости при оптимальном τ](/img/tau_opt.png)

---

## Оценка числа обусловленности

Используем **степенной метод** для нахождения максимального собственного значения.

Алгоритм:
1. Выбираем начальный ненулевой вектор $y^{(0)}$.
2. На каждой итерации:
   $$y^{(k+1)} = A y^{(k)}, \quad
   \lambda^{(k+1)} = \langle y^{(k+1)}, y^{(k)} \rangle$$
3. Нормируем $y^{(k+1)}$, проверяем сходимость:
   $$|\lambda^{(k+1)} - \lambda^{(k)}| < \varepsilon$$

Для нахождения $\lambda_{min}$ применяем степенной метод к матрице $B = \lambda_{max} I - A$.

Результаты:
$$\lambda_{max} \approx 17.97, \quad \lambda_{min} \approx 6.98$$

$$\mu(A) = \frac{\lambda_{max}}{\lambda_{min}} \approx 2.57$$

Реальные значения полученные через `np.linalg.eig`:

$$\lambda_{real,max} \approx 17.971963, \quad \lambda_{real,min} \approx 6.979513$$

$$\mu_{real}(A)\approx 2.574959$$

Полученные результаты при помощи степенного метода очень близки к реальным.

---

## Связь числа обусловленности с точностью

Пусть итерационный процесс имеет ошибку:
$e^{(k+1)} = (I - \tau A)e^{(k)}, \quad 
||e^{(k)}|| \le \rho^k ||e^{(0)}||$

где $\rho = \max_i |1 - \tau \lambda_i|$ — спектральный радиус матрицы итераций.  
Для симметричной положительно определённой матрицы при оптимальном шаге:

$$\tau_{opt} = \frac{2}{\lambda_{max} + \lambda_{min}}, \quad
\rho_{opt} = \frac{\lambda_{max} - \lambda_{min}}{\lambda_{max} + \lambda_{min}} = \frac{\mu - 1}{\mu + 1}$$

---

### Оценка числа итераций для $\varepsilon = 10^{-5}$

Для $\mu = 2.57$ имеем:
$$\rho_{opt} = \frac{2.57 - 1}{2.57 + 1} \approx 0.44$$
Необходимое число итераций:
$$k \ge - \frac{\ln(\varepsilon)}{\ln\left(\frac{\mu + 1}{\mu - 1}\right)} = \frac{\ln(10^5)}{\ln(1/0.44)} \approx 15$$

Следовательно, чтобы достичь относительной ошибки $10^{-5}$, достаточно **около 15 итераций** при $\tau = \tau_{opt}$.

---

## Сравнение теоретического и экспериментального шага

Теоретическое значение:
$$\tau_{teor,opt} = \frac{2}{\lambda_{max} + \lambda_{min}} = 0.08$$

Экспериментальное значение:
$$\tau_{exp,opt} = 0.072$$

Сравнение на графике:

![График сходимости метода Ричардсона при τ](/img/tau_final.png)

---

## Выводы

- Матрица симметрична, положительно определённа, с числом обусловленности $\mu(A) \approx 2.57$.  
- Оптимальный теоретический шаг $\tau_{teor,opt} = 0.08$, экспериментально найденное значение $\tau_{exp,opt} = 0.072$ даёт чуть лучшую сходимость на первых итерациях.  
- Использование числа обусловленности позволяет **оценить гарантированное число итераций**, необходимых для достижения заданной точности:
  $k \approx 15 \text{ при } \varepsilon = 10^{-5}.$
- Таким образом, метод Ричардсона при корректном выборе $\tau$ обеспечивает требуемую точность с малыми затратами вычислений.

---
