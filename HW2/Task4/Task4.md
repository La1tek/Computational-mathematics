# Task4 — Реализция метода Ричардсона решения системы уравнений.

> Все произведенные вычисления находятся в файле [Task4.ipynb](/HW2/Task4/Task4.ipynb)

---

## Цель

- Реализовать метод Ричардсона решения системы уравнений из задачи **II.10.5д**. 

- Оптимальное значение параметра $\tau$ подобрать экспериментально, основываясь на оценке скорости сходимости метода на первых 10 итерациях.

- При помощи степенного метода поиск максимального по модулю собственного значения оценить число обусловенности матрицы системы.

- Используя оценку числа обусловленности, получить решение системы с относительной точностью $\varepsilon = 10^{−5}$.

## СЛАУ из *10.5 д)*
$$
a = 10 \\
\begin{cases}
    a x_1 + x_2 + x_3 + x_4 + x_5 & = 1 \\
    x_1 + a x_2 + x_3 + x_4 + x_5 + x_6 & = 2 \\
    x_1 + x_2 + a x_3 + x_4 + x_5 + x_6 + x_7 & = 3 \\
    x_1 + x_2 + x_3 + a x_4 + x_5 + x_6 + x_7 + x_8 & = 4 \\
    x_1 + x_2 + x_3 + x_4 + a x_5 + x_6 + x_7 + x_8 + x_9 & = 5 \\
    x_2 + x_3 + x_4 + x_5 + a x_6 + x_7 + x_8 + x_9 + x_{10} & = 6 \\
    \vdots & \vdots \\
    x_{k-4} + x_{k-3} + x_{k-2} + x_{k-1} + a x_k + x_{k+1} + x_{k+2} + x_{k+3} + x_{k+4} & = k \\
    \vdots & \vdots \\
    x_{93} + x_{94} + x_{95} + x_{96} + a x_{97} + x_{98} + x_{99} + x_{100} & = 97 \\
    x_{94} + x_{95} + x_{96} + x_{97} + a x_{98} + x_{99} + x_{100} & = 98 \\
    x_{95} + x_{96} + x_{97} + x_{98} + a x_{99} + x_{100} & = 99 \\
    x_{96} + x_{97} + x_{98} + x_{99} + a x_{100} & = 100
\end{cases}
$$

Обознчим матрицу систему за $A$.

## Реализация

### Реализация метод Ричардсона решения системы уравнений.

**Итерационный процесс:**
$x^{(k+1)}=x^{(k)}−\tau r^{(k)}.$

**Применим теорему Гершгорина:** 
Каждое собственное значение матрицы A лежит по крайней мере в одном из кругов Гершгорина:

$D_i$ = { $z \in C:∣z−a_{ii}∣≤R_i$}, $i=1,2,…,n$

где $R_i = \sum_{j \neq i} |a_{ij}|$ — сумма модулей внедиагональных элементов i-й строки.


**Применим для матрицы системы II.10.5д:**

- *Диагональные элементы*: $a_{ii} = 10$
- *Внедиагональные элементы*: $a_{ij} = 1$ для $|i-j| \leq 4$, иначе $0$

**Радиусы Гершгорина:**

- Для строк 1-4 и 97-100 (крайние строки):
  - Количество соседей: от 4 до 7
  - $R_i \in [4,7]$
  - Круги: $|z-10| \leq R_i$

- Для строк 5-96 (внутренние строки):
  - Количество соседей: 8
  - $R_i = 8$
  - Круги: $|z-10| \leq 8$

Поскольку матрица $A$:
- **Симметричная** => все собственные значения вещественные
- **Положительно определенная** => все собственные значения положительные

Из теоремы Гершгорина следует:
$2 \leq \lambda_i \leq 18 \quad \forall i = 1,\ldots,100$

где $\lambda_i$ — собственные значения матрицы $A$.

Так как 
$\tau \in (0, \frac{2}{\lambda_{max}}) \Rightarrow \tau \in (0, \frac{1}{9})$

### Оптимальное значение параметра $\tau$.

Для каждого $\tau$ выполним метод Ричардсона на 10 итерациях и выбираем тот $\tau = \tau_{opt}$, при котором норма разности $||x^{(k+1)} - x^{(k)}||$ убывает быстрее всего.

Для $\tau \in (0.01, 0.1)$:

> График
![График сходимости метода Ричардсона](/HW2/Task4/img/tau.png)

Для $\tau \in (0.06, 0.08)$:

> График
![График сходимости метода Ричардсона](/HW2/Task4/img/tau_selected.png)

Отсюда оценка $\tau_{opt} \approx 0.072$ (при этом метод сходится)

График сходимости:

> График
![График сходимости метода Ричардсона](/HW2/Task4/img/tau_opt.png)

### Оценка числа обусловенности матрицы системы

**Алгоритм степенного метода**:

1. Выбор начального приближения:

   Выбираем произвольный ненулевой вектор $y^{(0)}$ - единичный.

2. Итерационный процесс:

   На каждой итерации $k = 0, 1, 2, \dots$ выполняем:

   - Вычисляем новый вектор: $y^{(k+1)} = A y^{(k)}$

   - Вычисляем приближение собственного значения: $\lambda^{(k+1)}=\langle y^{(k+1)},y^{(k)} \rangle$

   - Нормализуем полученный вектор:
     $y^{(k+1)} = \dfrac{y^{(k+1)}}{\|| y^{(k+1)} \||}$

   - Проверяем условие остановки:
     $| \lambda^{(k+1)} - \lambda^{(k)} | < \varepsilon$,
     где $\varepsilon$ — заданная точность.

3. Критерий остановки:

   Если условие остановки выполнено, то принимаем $\lambda_{max} = \lambda^{(k+1)} $.

**Применение к задаче**:

- Запустим алгоритм для матрицы $A$, получим $\lambda_{max}$

- Для того, Чтобы оценить $ \lambda_{min} $, используем степенной метод для матрицы $B = \lambda_{max}I - A$.

- Получим $\mu_{max}= \lambda_{max} - \lambda_{min}$.

- Тогда $\lambda_{min}= \lambda_{max} - \mu_{max}$

Для нашей матрицы $A$:

- $\lambda_{{max}} \approx 17.97$
- $\lambda_{{min}} \approx 6.98$

Тогда число обусловленности:
$\mu(A) = \dfrac{17.97}{6.98} \approx 2.57$

### Получим решение системы, используя оценку числа обусловленности.

Так как матрица положительноопределнная и симметричная $\tau_{teor,opt} = \frac{2}{\lambda_{max} + \lambda_{min}} = 0.08$.

Но из первого пункта мы нашли $\tau_{exp,opt} = 0.072$ - при таком значении норма разности $||x^{(k+1)} - x^{(k)}||$ убывает быстрее всего.

Используем оба этих значения и сравним результаты.

![График сходимости метода Ричардсона](/HW2/Task4/img/tau_final.png)

## Выводы


- Полученное экспериментальным путем $\tau_{exp}$ дает лучшую сходимость метода, по сравнению с $\tau_{teor}$, так как теоритическое решение является асимптотически оптимальным (она минимизирует спектральный радиус матрицы $M=I−\tau A$). Оно делает сходимость максимально быстрой в пределе большого числа итераций $k \to \infty$, но не гарантирует, что ошибка после, например, 20 шагов будет минимальной.
