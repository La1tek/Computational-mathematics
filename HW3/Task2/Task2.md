# Task2 - Аппроксимация численности населения США.

## Цель

- Используя многочлены степеней $N = 2, 3, 4, 5$ построить аппроксимацию по двум различным базисам
- Использовать построенные приближения для предсказания численности населения США в 2010 году

## Данные

| Год  | Население   |
|------|-------------|
| 1910 | 92,228,496  |
| 1920 | 106,021,537 |
| 1930 | 123,202,624 |
| 1940 | 132,164,569 |
| 1950 | 151,325,798 |
| 1960 | 179,323,175 |
| 1970 | 203,211,926 |
| 1980 | 226,545,805 |
| 1990 | 248,709,873 |
| 2000 | 281,421,906 |

Точное значение для 2010 года - 308,745,538

## Реализация

## Базисы для аппроксимации
- $(x - 1910)^n$ для пункта (б).
```python
def basis_b(N):
    return [lambda x, n=n: (x - 1910)**n for n in range(N+1)]
```
- $(\frac{(x-1955)}{45})^n$ для пункта (г).
```python
def basis_d(N):
    return [lambda x, n=n: ((x - 1955)/45)**n for n in range(N+1)]
```



### Скалярное произведение для векторов

Реализуется как $\langle u, v \rangle = u^Tv$

```python
def dot_product(u, v):
    return np.dot(u, v)
```

### Построение системы линейных уравнений

- `g[i]` — вектор значений i-го базиса в точках `years` (переходим от функций к векторам значений)
- `M` — матрица Грамма: `<g_i, g_j>`.
- `b` — вектор правой части: `<g_i, y>`.

```python
def build_system(basis, y_values):
    n = len(basis)
    M = np.zeros((n, n))
    b = np.zeros(n)
    g = [b_func(years) for b_func in basis]

    for i in range(n):
        b[i] = dot_product(g[i], y_values)
        for j in range(n):
            M[i, j] = dot_product(g[i], g[j])
    return M, b
```

### Решение системы линейных уравнений и предсказание для 2010 года

- Для каждого значения степени N строится базис.
- Строется матрица $M$ и правая часть $b$
- Вычисляются коэффициенты $c_i$ через решение системы $M \alpha = b$.
- Считаем население в 2010 году прямой подстновкой.
- Для каждого $N$ вычисляем относительную ошибку предсказания.

## Результаты аппроксимации

### Аппроксимация для $(x - 1910)^n$

| N | Предсказано 2010 | Ошибка (%) |
|---|-----------------|------------|
| 2 | 312,470,336     | 1.206      |
| 3 | 309,020,979     | 0.089      |
| 4 | 305,706,175     | 0.984      |
| 5 | 305,705,684     | 0.985      |

### Аппроксимация для $((x - 1955)/45)^n$

| N | Предсказано 2010 | Ошибка (%) |
|---|-----------------|------------|
| 2 | 312,470,336     | 1.206      |
| 3 | 309,020,979     | 0.089      |
| 4 | 305,706,175     | 0.984      |
| 5 | 340,607,732     | 10.320     |


### Графики

![Пункт б](/aprroxB.png)

![Пункт г](/approxD.png)

### Сравнение результатов аппроксимации и минимизируемого функционала

> Два разных базиса должны давать одинаковые решения, или нет?  

Два разных базиса **не обязательно** дают одинаковые решения, так как каждый только задает свое подпространство и проецирует на него. Два базиса не обязаны задавать одно и тоже подпространство, а значит могут быть и разные решения.

> Сравним значения минимизируемого функционала во всех случаях.  

#### Значения минимизируемого функционала $F = \langle f - \alpha_i g_i,f - \alpha_i g_i \rangle$

| Базис | N | Значение функционала \(F\) |
|-------|---|----------------------------|
| $(x - 1910)^n$ | 2 | **$8.492 \cdot 10^{13}$** |
| $(x - 1910)^n$ | 3 | **$7.993 \cdot 10^{13}$** |
| $(x - 1910)^n$ | 4 | **$7.839 \cdot 10^{13}$** |
| $(x - 1910)^n$ | 5 | **$3.193 \cdot 10^{13}$** |

| Базис | N | Значение функционала \(F\) |
|-------|---|----------------------------|
| $((x - 1955)/45)^n$ | 2 | **$8.492 \cdot 10^{13}$** |
| $((x - 1955)/45)^n$ | 3 | **$7.993 \cdot 10^{13}$** |
| $((x - 1955)/45)^n$ | 4 | **$7.839 \cdot 10^{13}$** |
| $((x - 1955)/45)^n$ | 5 | **$3.193 \cdot 10^{13}$** |

#### Вывод:

- Численные значения функционала $F$ для двух базисов **совпадают**.  
- Это подтверждает, что оба базиса порождают **одно и то же линейное подпространство** полиномов степени ≤ N, а значит, **аппроксимирующая функция одинакова**.

---

> Какой базис лучше? Как это можно понять?

#### Как понять, какой базис лучше?

- При одинаковом значении минимизируемого функционала  
  оба базиса дают **одинаковое качество аппроксимации** — ведь значение \(F\) показывает суммарное квадратичное отклонение модели от данных.

- Сдвиг и масштабирование аргумента (например, переход к $(\frac{x - 1955}{45})^n$
  делают значения базисных функций ближе к единице,  
  уменьшают величины элементов матрицы $M$ и тем самым **улучшают численную устойчивость** при вычислении коэффициентов.  
  Это особенно важно при больших степенях полинома, когда исходный базис $(x - 1910)^n$ приводит к большим числам и потере точности.
