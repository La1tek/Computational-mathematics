# Task2 - Аппроксимация численности населения США.

> Все расчеты находятся в файле [Task2.ipynb](/HW3/Task2/Task2.ipynb)

## Цель

- Используя многочлены степеней $N = 2, 3, 4, 5$ построить аппроксимацию по двум различным базисам
- Использовать построенные приближения для предсказания численности населения США в 2010 году

## Данные

| Год  | Население   |
|------|-------------|
| 1910 | 92,228,496  |
| 1920 | 106,021,537 |
| 1930 | 123,202,624 |
| 1940 | 132,164,569 |
| 1950 | 151,325,798 |
| 1960 | 179,323,175 |
| 1970 | 203,211,926 |
| 1980 | 226,545,805 |
| 1990 | 248,709,873 |
| 2000 | 281,421,906 |

Точное значение для 2010 года - 308,745,538

## Реализация

## Базисы для аппроксимации
- $(x - 1910)^n$ для пункта (б).
```python
def basis_b(N):
    return [lambda x, n=n: (x - 1910)**n for n in range(N+1)]
```
- $(\frac{(x-1955)}{45})^n$ для пункта (г).
```python
def basis_d(N):
    return [lambda x, n=n: ((x - 1955)/45)**n for n in range(N+1)]
```



### Скалярное произведение для векторов

Реализуется как $\langle u, v \rangle = u^Tv$

```python
def dot_product(u, v):
    return np.dot(u, v)
```

### Построение системы линейных уравнений

- `g[i]` — вектор значений i-го базиса в точках `years` (переходим от функций к векторам значений)
- `M` — матрица Грамма: `<g_i, g_j>`.
- `b` — вектор правой части: `<g_i, y>`.

```python
def build_system(basis, y_values):
    n = len(basis)
    M = np.zeros((n, n))
    b = np.zeros(n)
    g = [b_func(years) for b_func in basis]

    for i in range(n):
        b[i] = dot_product(g[i], y_values)
        for j in range(n):
            M[i, j] = dot_product(g[i], g[j])
    return M, b
```

### Решение системы линейных уравнений и предсказание для 2010 года

- Для каждого значения степени N строится базис.
- Строется матрица $M$ и правая часть $b$
- Вычисляются коэффициенты $c_i$ через решение системы $M \alpha = b$.
- Считаем население в 2010 году прямой подстновкой.
- Для каждого $N$ вычисляем относительную ошибку предсказания.

## Результаты аппроксимации

### Аппроксимация для $(x - 1910)^n$

| N | Предсказано 2010 | Ошибка (%) |
|---|-----------------|------------|
| 2 | 312,470,336     | 1.206      |
| 3 | 309,020,979     | 0.089      |
| 4 | 305,706,175     | 0.984      |
| 5 | 305,705,684     | 0.985      |

### Аппроксимация для $((x - 1955)/45)^n$

| N | Предсказано 2010 | Ошибка (%) |
|---|-----------------|------------|
| 2 | 312,470,336     | 1.206      |
| 3 | 309,020,979     | 0.089      |
| 4 | 305,706,175     | 0.984      |
| 5 | 340,607,732     | 10.320     |


### Графики

![Пункт б](/HW3/Task2/img/aprroxB.png)

![Пункт г](/HW3/Task2/img/approxD.png)
